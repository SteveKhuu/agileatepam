{% load i18n %}
{% load static %}
<html>
	<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
	<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
	<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
	<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<body>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title>Agile@EPAM</title>
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width">
		<link rel="stylesheet" href="{% get_static_prefix %}xf/styles/xf.css"/>
		<link rel="stylesheet/less" type="text/css" href="{% get_static_prefix %}xf/styles/xf.less" />
		<link rel="stylesheet/less" type="text/css" href="{% get_static_prefix %}css/main.less" />
		<script src="{% get_static_prefix %}xf/js/lib/jquery-1.7.1.min.js"></script>
		<script src="{% get_static_prefix %}xf/js/lib/underscore.js"></script>
		<script src="{% get_static_prefix %}xf/js/lib/iscroll-lite.js"></script>
		<script src="{% get_static_prefix %}xf/js/lib/helper.js"></script>
		<script src="{% get_static_prefix %}xf/js/xf.js"></script>
		<script src="{% get_static_prefix %}js/less.js" type="text/javascript"></script>
		<script src="{% get_static_prefix %}js/ajax.js"></script>
	</head>

<script>
$(function(){
    XF.start({
    settings: {
		componentUrlPrefix: '{% get_static_prefix %}js/',
		templateUrlPrefix: '{% get_static_prefix %}tmpl/',
	},
    router: {
        routes: {
		'':         'home',
		'/':        'home',
		'home':     'home',
		'about':    'about',
		'news/:id': 'news'
		},
        handlers: {
			news: function(id) {
				var home = XF.getComponentByID('app-home-component');
				home.selectedNewsID = id;
				var newsDetailsComponent =
				XF.getComponentByID('app-news-details-component');
				if(newsDetailsComponent) {
					newsDetailsComponent.refresh();			
				}
			}
		}
	}
    });
    
    $(".triggerChat").live("click",function(evt) {
        evt.preventDefault();
        
        var url = window.location.href;
        var arr = url.split("/");
        var host = arr[2].split(":")[0]
        var port = 8888;
        var uri = "chat";

        ws = new WebSocket("ws://localhost:8888/chat");

        ws.onmessage = function(evt) {alert("message received: " + evt.data)};

        ws.onclose = function(evt) { alert("Connection close"); };
        
        ws.onopen = function() {
            ws.send("test");
        }
        
      });
    
});
</script>
    <script src="{% get_static_prefix %}js/less.js"></script>

    <div id="app-root" data-id="app-root" data-component="appRoot">
        <div class="xf-dialog  xf-dialog-notification"><div class="xf-dialog-content"><div class="xf-notification"><div class="xf-notification-wrap"><div class="xf-notification-text">Loading...</div></div></div></div></div>
    </div>
</body>
</html>